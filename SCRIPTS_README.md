# 启动和关闭脚本使用说明

## 📋 脚本说明

项目根目录下提供了两个便捷脚本：

- **start.sh** - 启动所有服务（后端 + 前端）
- **stop.sh** - 停止所有服务

## 🚀 使用方法

### 启动服务

```bash
# 方法1: 直接运行
./start.sh

# 方法2: 使用bash运行
bash start.sh
```

启动脚本会自动：
- ✅ 检查并停止已运行的服务
- ✅ 检查环境依赖
- ✅ 启动后端服务（端口 8000）
- ✅ 启动前端服务（端口 5173）
- ✅ 验证服务是否成功启动
- ✅ 显示服务访问地址

### 停止服务

```bash
# 方法1: 直接运行
./stop.sh

# 方法2: 使用bash运行
bash stop.sh
```

停止脚本会自动：
- ✅ 停止后端服务
- ✅ 停止前端服务
- ✅ 清理相关进程
- ✅ 验证服务是否已停止

## 📁 文件结构

启动服务后，会在项目根目录创建 `logs/` 目录：

```
logs/
├── backend.pid      # 后端进程ID
├── frontend.pid     # 前端进程ID
├── backend.log      # 后端日志
└── frontend.log     # 前端日志
```

## 🔍 查看日志

```bash
# 查看后端日志
tail -f logs/backend.log

# 查看前端日志
tail -f logs/frontend.log
```

## ⚠️ 注意事项

1. **首次使用前**：确保已配置 `backend/.env` 文件，包含 `GEMINI_API_KEY`
2. **端口占用**：如果端口被占用，脚本会自动尝试停止占用端口的进程
3. **Python环境**：脚本会自动检测并使用 anaconda Python 或系统 Python
4. **依赖检查**：启动前会自动检查必要的依赖是否已安装

## 🆘 故障排除

### 如果启动失败

1. 检查日志文件：`logs/backend.log` 和 `logs/frontend.log`
2. 检查端口是否被占用：
   ```bash
   lsof -i :8000
   lsof -i :5173
   ```
3. 手动停止服务后重试：
   ```bash
   ./stop.sh
   ./start.sh
   ```

### 如果停止失败

可以手动停止：
```bash
# 停止后端
lsof -ti :8000 | xargs kill -9

# 停止前端
lsof -ti :5173 | xargs kill -9
```

## 📝 示例输出

### 启动成功示例

```
========================================
  AI作业批改助手 - 启动服务
========================================

[1/4] 检查后端环境...
[2/4] 检查前端环境...
[3/4] 启动后端服务 (端口 8000)...
✅ 后端服务已启动 (PID: 12345)
[4/4] 启动前端服务 (端口 5173)...
✅ 前端服务已启动 (PID: 12346)

========================================
  ✅ 所有服务已成功启动！
========================================

📱 前端应用: http://localhost:5173
🔧 后端API:  http://localhost:8000
📚 API文档:  http://localhost:8000/docs

📝 日志文件:
   - 后端: logs/backend.log
   - 前端: logs/frontend.log

🛑 停止服务: 运行 ./stop.sh 或 bash stop.sh
```

